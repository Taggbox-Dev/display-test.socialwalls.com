"use strict";(self.webpackChunkembed_widget=self.webpackChunkembed_widget||[]).push([[4877],{64877:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var r=a(9950),s=a(11127),i=a(19015),o=a(52867),n=a(66345),d=a(83744),l=a(80415),c=a(44414);function p(e){e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("display","flex","important"),e.style.setProperty("transform","none","important"),e.style.setProperty("clip-path","initial","important")}class u extends r.PureComponent{render(){return(0,c.jsx)("a",{href:l.om,target:"_blank",ref:e=>{e&&(e.style.setProperty("margin-right","15px","important"),e.style.setProperty("width","90px","important"),e.style.setProperty("height","auto","important"),p(e))},children:(0,c.jsx)("img",{ref:e=>{e&&(e.style.setProperty("width","100%","important"),e.style.setProperty("height","auto","important"),p(e))},src:`${l.th}/media/images/tagshop-branding.svg`})})}}r.Component;r.Component;var h=a(86069);const m=e=>{let{product:t,wall:a,onsetProductImg:s,openAddtocart:o,item:n,setOnProductDetails:l}=e;const[p,u]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1),g=(a.User.id,a.ProductSetting.Button),_=(e,t)=>{var a;return(0,i.hq)({type:1,action:2,wall:null===e||void 0===e||null===(a=e.Wall)||void 0===a?void 0:a.id,product_id:t.id,post:n.referenceId,owner:e.Wall.owner,feed:n.feedId,currency:t.price_currency,price:t.product_discount>0?t.product_discount:t.product_price})},P=e=>{const{Button:t}=a.ProductSetting;var r=e;2==parseInt(t.newTab)?window.parent.location.href=r:window.open(r,"_blank")},w=t.UgcProduct;return(0,c.jsxs)("div",{className:"tb_rpp_pro "+(p?"ts_reelTheme_No_Product":""),children:[p?null:(0,c.jsx)("div",{className:"tb_rpp_pro_img",children:(0,c.jsx)("img",{src:w.product_image,alt:"",onError:()=>u(!0)})}),(0,c.jsxs)("div",{className:"tb_rpp_pro_cont",children:[(0,c.jsx)("div",{className:"tb_rpp_pro_title",children:w.product_title}),w.product_price>0||w.product_discount>0?(0,c.jsxs)("div",{className:"tb_rpp_p_wrap",children:[(0,c.jsxs)("div",{className:"tb_rpp_p",children:[w.price_currency_symbol,w.product_discount>0?w.product_discount:w.product_price]}),0==w.product_discount||w.product_price==w.product_discount?(0,c.jsx)(c.Fragment,{}):(0,c.jsxs)("div",{className:"tb_rpp_p tb_rpp_d_p",children:[w.price_currency_symbol,w.product_price]})]}):null,(0,c.jsxs)("div",{className:"tb_rpp_btn"+(h?" tb_rpp_btn_spinner":""),disabled:h,onClick:()=>{(async()=>{m(!0);const e={};if(t&&t.UgcProduct&&t.UgcProduct.product_url)try{var r,i,n;140717==(null===a||void 0===a||null===(r=a.Wall)||void 0===r?void 0:r.owner)||1==(null===a||void 0===a||null===(i=a.ProductSetting)||void 0===i||null===(n=i.Button)||void 0===n?void 0:n.pdp_target)?(P(t.UgcProduct.product_url),s(t.product_image),m(!1),_(a,t.UgcProduct)):(0,d.YS)(t.UgcProduct.product_url).then(a=>{a.data&&(e[t.id]=a.data,s(a.data.featured_image?a.data.featured_image:t.product_image),m(!1),l(e),o(t.id,t))}).catch(e=>{console.log("error",e),P(t.UgcProduct.product_url),s(t.product_image),m(!1),_(a,t.UgcProduct)})}catch(c){console.log("error",c),P(t.UgcProduct.product_url),m(!1)}})()},children:[g.text," "]})]})]})},g=(0,r.memo)(m),_=r.lazy(()=>Promise.all([a.e(1823),a.e(8262)]).then(a.bind(a,78262))),P=r.lazy(()=>Promise.all([a.e(8092),a.e(4005)]).then(a.bind(a,80426))),w=r.lazy(()=>a.e(4116).then(a.bind(a,34116))),D=e=>{const{itemData:t,wallID:a,ownerId:s,wall:i,muted:o,autoPlay:n,index:d}=e,l=!1;return(0,c.jsx)("div",{className:"tb_rp_media_wrap",children:t.imageList&&t.imageList.length>0?(0,c.jsx)(r.Suspense,{fallback:(0,c.jsx)(c.Fragment,{}),children:(0,c.jsx)(w,{imageList:t.imageList,...e})}):2!==t.type&&4!==t.type&&n?3===t.type||5===t.type?(0,c.jsx)(r.Suspense,{fallback:(0,c.jsx)(c.Fragment,{}),children:(0,c.jsx)(P,{VideoClass:"tb_rp_video",data:{...t,postFileNew:t.filename},wallID:a,themeID:i.Personalization.widgetTheme,ownerId:s,size:l,isCover:!0,controls:!1,autoPlay:n,muted:o,handleVideoEnded:()=>{},index:d})}):null:(0,c.jsx)(r.Suspense,{fallback:(0,c.jsx)(c.Fragment,{}),children:(0,c.jsx)(_,{ImageClass:"tb_rp_image",data:{...t,postFileNew:t.filename},wallID:a,themeID:i.Personalization.widgetTheme,ownerId:s,size:l,ThemeRule:i.ThemeRule})})})},x=(0,r.memo)(D);var v=a(68940);a(99425);const y=e=>{let{wall:t,item:a,personalization:r,productLoading:s,showAddToCart:i,onsetProductImg:o,openAddtocart:n,setOnProductDetails:d,isFreePlan:l,index:p,currentVideo:h,muteToggle:m,muted:_}=e;const P=a.ugc_products,w=!(3!==a.type&&5!==a.type||!h);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(x,{itemData:a,wallID:t.Wall.wallId,ownerId:t.Wall.owner,ThemeID:r.widgetTheme,wall:t,muted:_,autoPlay:w,index:p}),(0,c.jsxs)("div",{className:"tb_rp_content",children:[t.ProductSetting&&1==r.themeType&&P&&P.length>0?(0,c.jsx)(v.RC,{autoHeight:!0,speed:400,edgeSwipeDetection:!0,slidesPerView:a.ugc_products&&a.ugc_products.length>1?1.3:1,touchRatio:2,spaceBetween:0,mousewheel:{forceToAxis:!0,sensitivity:2},watchSlidesProgress:!0,direction:"horizontal",className:"tb_rpp_wrap",children:a.ugc_products&&a.ugc_products.map((e,r)=>(0,c.jsx)(v.qr,{children:(0,c.jsx)(g,{product:e,openAddtocart:n,onsetProductImg:o,showAddToCart:i,productLoading:s,wall:t,ugcSetting:t.ProductSetting,item:a,setOnProductDetails:d})},r))}):null,w?(0,c.jsx)("div",{className:"tb_rp_mute_btn",onClick:m,children:(0,c.jsx)("div",{className:"tb__icon tb-"+(_?"mute":"unmute"),children:(0,c.jsx)("div",{})})}):null,t.UserRule.branding_lite&&1==t.UserRule.branding_lite||l?(0,c.jsx)(u,{wallId:t.Wall.id,themeID:t.Personalization.widgetTheme}):null]})]})},I=(0,r.memo)(y);(0,a(58207).kz)();class S extends r.Component{constructor(e){var t;super(e),this.setMuted=e=>this.setState({muted:!this.state.muted}),this.setOnProductDetails=e=>this.setState({allProductDetails:e}),this.onErrorVideo=e=>this.setState({isVideoError:!0}),this.onMediaUpdate=e=>this.setState({isAuthorImagevalid:!1}),this.onAddToCart=(e,t,a)=>{const{wall:r}=this.props;setTimeout(()=>{this.setState({addCartSetTime:!0})},100);const s={type:1,action:2,wall:r.Wall.id,feed:a.feedId,post:a.referenceId?a.referenceId:a.id,owner:r.Wall.owner,product_id:t.UgcProduct.id,currency:t.UgcProduct.price_currency,price:t.UgcProduct.product_discount>0?t.UgcProduct.product_discount:t.UgcProduct.product_price};this.setState({addtoCartPopup:!0,selectedProductDetails:this.state.allProductDetails[e],tagshopProductDeatil:{...t,trackingData:s}})},this.requestData=()=>{const{wall:e,appendData:t,hasMoreData:a,loaderData:r}=this.props,s=e.ThemeRule.numberOfPosts,i=Math.floor(Date.now()/1e3);a&&!r.isShowMoreLoading&&this.props.getDataNextSteps(e.Wall.id,i,s,t.networkID,t.after,t.heightEvent)},this.onItemChange=e=>this.setState({item:e}),this.currentSwiperSlide=e=>{this.props.hasMoreData&&e.progress>.9&&this.requestData(),this.onPopUpTrack(e.activeIndex)},this.onPopUpTrack=e=>{try{const{wall:t,completeData:a}=this.props;let r=a[e]?a[e]:null;if(r){const e={feed:r.feedId,post:r.referenceId?r.referenceId:r.id},a={wallId:t.Wall.id,userId:t.Wall.owner,feedId:r.feedId,postId:r.id},s={action:2,wall:t.Wall.id,feed:r.feedId,post:r.referenceId?r.referenceId:r.id,type:3,owner:t.Wall.owner};(0,i.hq)(n.uS?a:n.Qy?s:{action:2,wall:t.Wall.id,...e,owner:t.Wall.owner})}}catch(t){console.log("Error in PopUp Tracking",t)}},this.startSwiperSlide=e=>{this.setState({activeSlide:e.activeIndex})},this.onClickClosePopUp=e=>this.setState({addtoCartPopup:!1,continueShopping:!1,selectedProductDetails:null,addCartSetTime:!1}),this.onClickCheckOut=e=>this.setState({addtoCartPopup:!0,continueShopping:!1}),this.sliderRef=r.createRef(),this.state={currentIndex:null===(t=this.props)||void 0===t?void 0:t.currentIndex,item:this.props.item,isVideoError:!1,windowWidth:window.innerWidth,isAuthorImagevalid:!0,instaImg:(0,o.kR)(this.props.imgData,this.props.item.link),isHotspot:!1,addtoCartPopup:!1,allProductDetails:null,selectedProductId:null,selectedProductDetails:null,continueShopping:!1,selectedVariant:null,showAddToCart:!1,productLoading:!0,productImg:"",tagshopProductDeatil:null,muted:!0,activeSlide:0,addCartSetTime:!1,selectedProdDetails:null,tagProdDetail:null},this.splideRef=r.createRef()}componentDidMount(){const{currentIndex:e,item:t}=this.props,a=(0,o.hz)(t.author.picture);this.setState({currentIndex:e,item:t,isAuthorImagevalid:a,instaImg:(0,o.kR)(this.props.imgData,this.props.item.link)}),this.splideRef.current.addEventListener("swiperslidechange",e=>{this.props.hasMoreData&&e.detail[0].progress>.9&&(this.requestData(),this.setState({currentIndex:this.splideRef.current.swiper.activeIndex}))})}componentWillReceiveProps(e){const{currentIndex:t,item:a}=e,r=(0,o.hz)(a.author.picture);this.setState({currentIndex:t,item:a,isVideoError:!1,isAuthorImagevalid:r,instaImg:(0,o.kR)(this.props.imgData,this.props.item.link)})}render(){const{personalization:e,onClosePopUp:t,slideWithArrowKeys:a,wall:r,webFilters:s,completeData:i,isFreePlan:o}=this.props,{currentIndex:n,item:d,isVideoError:l,instaImg:p,addtoCartPopup:u,selectedProductDetails:m,continueShopping:g,selectedVariant:_,showAddToCart:P,productImg:w,productLoading:D,tagshopProductDeatil:x,activeSlide:y,addCartSetTime:S,muted:b,selectedProdDetails:C,tagProdDetail:f}=this.state;return(0,c.jsxs)("div",{className:`modalId${d.id} tb_rp_modal ${S?"tb_rp_add_cart_m":""}`,onKeyDown:a,onKeyPress:a,onLoad:a,onClick:e=>e.currentTarget==e.target&&t(e),children:[(0,c.jsxs)("div",{className:"tb_rp_dialog",children:[u||g?null:(0,c.jsx)("div",{className:"tb_reel_close_btn",onClick:t,children:(0,c.jsx)("div",{className:"tb__icon tb-close-thin",children:(0,c.jsx)("div",{})})}),(0,c.jsx)("div",{className:"tb_time_line_wrap",children:(0,c.jsx)("div",{className:"tb_time_line",children:(0,c.jsx)("div",{})})}),(0,c.jsx)(v.RC,{ref:this.splideRef,direction:"vertical",touchRatio:2,freeMode:JSON.stringify({enabled:!0,sticky:!0}),height:`${window.innerHeight}`,initialSlide:n,passiveListeners:!0,mousewheel:{forceToAxis:!0,sensitivity:2},watchSlidesProgress:!0,onSlideChange:e=>this.currentSwiperSlide(e),children:i&&i.length>0?i.map((a,s)=>(0,c.jsx)(v.qr,{children:i=>{let{isActive:n}=i;return(0,c.jsx)(I,{currentVideo:n,onClosePopUp:t,wall:r,item:a,instaImg:p,showAddToCart:P,openAddtocart:(e,t)=>this.onAddToCart(e,t,a),onsetProductImg:e=>this.setState({productImg:e}),productLoading:D,sliderRef:this.sliderRef,personalization:e,isVideoError:l,addtoCartPopup:u,continueShopping:g,setOnProductDetails:this.setOnProductDetails,isFreePlan:o,muteToggle:this.setMuted,muted:b},`${a.id}-${s}`)}},`${a.id}-${s}`)):(0,c.jsx)(c.Fragment,{})})]}),u&&m?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"tb_rp_cart_overlay",children:(0,c.jsx)("div",{})}),(0,c.jsx)("div",{className:"tb_rp_cart_modal",children:(0,c.jsxs)("div",{className:"tb_rp_cart_body",children:[(0,c.jsx)("div",{className:"ts_reel_close_btn tb_reel_close_btn",onClick:u&&!g?this.onClickClosePopUp:g?e=>this.setState({addtoCartPopup:!0,continueShopping:!1}):null,children:(0,c.jsx)("div",{className:"tb__icon tb-close-thin",children:(0,c.jsx)("div",{})})}),(0,c.jsx)("div",{className:"tb_rp_cart_wrap",children:m&&Object.keys(m).length>0?(0,c.jsx)(h.A,{productImg:w,addtoCartPopup:u,productDetails:{data:m},tagshopProductDeatil:x,closeCart:e=>this.setState({addtoCartPopup:!1,continueShopping:!1,selectedProductDetails:null}),onAddToCart:()=>this.setState({continueShopping:!0}),onSelectedVariant:e=>this.setState({selectedVariant:e}),wall:r,closePopUp:this.props.onClosePopUp}):null})]})})]}):null]})}}const b=(0,s.Ng)(e=>{const{appData:t}=e;return{loaderData:e.loaderData,appendData:t.postData.appendData,hasMoreData:!t.postData.hasMoreData[0]||0!=t.postData.hasMoreData[0].hasMoreData&&(!t.postData.hasMoreData[t.postData.appendData.networkID]||t.postData.hasMoreData[t.postData.appendData.networkID].hasMoreData)}},e=>({getDataNextSteps:(t,a,r,s,o,n,d)=>e((0,i.H5)(t,a,r,s,o,n,d))}))((0,r.memo)(S));class C extends r.PureComponent{constructor(){super(...arguments),this.state={isEnable:0,eventData:{},shareText:"SHARE",viewOnText:"View on",currentIndex:null,completeData:{},personalization:{},url:null,imgData:[]},this.closeCommercePopUP=e=>{this.setState({isEnable:0,currentIndex:null},()=>this.props.closePopUP());var t=document.getElementsByTagName("html");t&&t[0]&&(t[0].style.overflow="")},this.getCommercePopUPEvent=e=>{void 0!==e&&""!==e&&e.card&&this.setState({url:"",isEnable:1,eventData:e,currentIndex:e.index,completeData:e.idArray,viewOnText:e.viewOnText,shareText:e.shareText,windowParent:e,imgData:e.imgData,personalization:e.personalization},()=>this.CommercePopUPSlideWithArrowKey())},this.featuredPopSliderChangeIndex=e=>t=>{const{eventData:a}=this.state;-1===e?this.setState({currentIndex:a.idArray.length-1}):this.setState({currentIndex:a.idArray.length===e?0:e})},this.SliderWithKey=e=>{const{eventData:t}=this.state;-1===e?this.setState({currentIndex:t.idArray.length-1}):this.setState({currentIndex:t.idArray.length===e?0:e})},this.CommercePopUPSlideWithArrowKey=e=>{const{personalization:t}=this.state;if(t&&1===t.popupSlideShow){let t=this;(e=e||window.event)&&e.keyCode&&void 0!==e.keyCode&&(37===e.keyCode?t.SliderWithKey(t.state.currentIndex-1):39===e.keyCode?t.SliderWithKey(t.state.currentIndex+1):27===e.keyCode&&this.closeCommercePopUP())}}}componentDidMount(){const{data:e}=this.props;this.getCommercePopUPEvent(e);var t=document.getElementsByTagName("html");t&&t[0]&&(t[0].style.overflow="hidden")}componentDidUpdate(e){this.props.data!==e.data&&this.getCommercePopUPEvent(this.props.data)}componentWillReceiveProps(e){const{postData:t}=e;let{completeData:a,eventData:r}=this.state;if(a.length!=t.postData.length){let e=t.postData.map(e=>t.completeDataObject[e]).filter(e=>!String(e.id).includes("free_add_"));r.idArray=e,this.setState({completeData:e,eventData:r},()=>{const{currentIndex:e}=this.state;this.setState({currentIndex:e+1})})}else{!(t.hasMoreData&&Object.keys(t.hasMoreData).length>0)||(!t.hasMoreData[0]||0!=t.hasMoreData[0].hasMoreData)&&(!t.hasMoreData[t.appendData.networkID]||t.hasMoreData[t.appendData.networkID].hasMoreData)}}render(){const{viewOnText:e,isEnable:t,currentIndex:a,personalization:r,completeData:s,eventData:i,url:o,imgData:n}=this.state,{postData:d}=this.props;let l=null;l=-1===a?s[i.idArray.length-1]:s[a];const{wall:p,webFilters:u}=this.props;return 1===t&&p&&s&&Object(s).length>0?(0,c.jsx)(b,{webFilters:u,wall:p,item:l,completeData:s,onClosePopUp:this.closeCommercePopUP,currentIndex:a,personalization:r,viewOnText:e,slideWithArrowKeys:this.CommercePopUPSlideWithArrowKey,featuredPopSliderChangeIndex:this.featuredPopSliderChangeIndex,hostUrl:o,imgData:n,isFreePlan:d&&d.isFreeAdsStatus}):null}}const f=(0,s.Ng)(e=>({wall:e.appData.wall,webFilters:e.appData.webFilters}),e=>({closePopUP:t=>e((0,i.ng)(t))}))(C)}}]);